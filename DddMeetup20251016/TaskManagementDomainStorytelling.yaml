openapi: 3.1.0
info:
  title: Task Management API
  description: |
    Task Management system for clerks to create, assign, and manage tasks.
    Clerks can create new tasks, assign them to team members, and track progress.
    The system supports task lifecycle management from creation to completion.
  contact:
    email: admin@task-management.org
    name: Task Management Team
    url: https://api.task-management.org
  version: 1.0.0
  x-api-id: a1b2c3d4-e5f6-7890-ab12-cd3456ef7890
  x-audience: external-public
servers:
  - url: 'https://api.task-management.org/v1/'
security:
  - openIdConnect:
      - task:read
      - task:write
      - task:admin
tags:
  - name: Tasks
    description: All endpoints to manage tasks in the system
  - name: Assignments
    description: All endpoints to manage task assignments
  - name: Inbox
    description: All endpoints to manage task inbox operations
paths:
  /tasks:
    get:
      description: Retrieves a list of tasks with optional filtering
      operationId: getTasks
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:read
      parameters:
        - $ref: '#/components/parameters/VersionParameter'
        - name: status
          in: query
          description: Filter tasks by status
          schema:
            $ref: '#/components/schemas/TaskStatus'
        - name: assignedTo
          in: query
          description: Filter tasks by assigned clerk ID
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          description: Maximum number of tasks to return
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of tasks to skip for pagination
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          $ref: '#/components/responses/TaskListResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

    post:
      description: Creates a new task
      operationId: createTask
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:write
      parameters:
        - $ref: '#/components/parameters/VersionParameter'
      requestBody:
        $ref: '#/components/requestBodies/CreateTaskRequest'
      responses:
        '201':
          $ref: '#/components/responses/LinkToTaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /tasks/{taskId}:
    get:
      description: Retrieves a single task by its identifier
      operationId: getTaskById
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:read
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      responses:
        '200':
          $ref: '#/components/responses/TaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

    put:
      description: Updates a task with all possible fields
      operationId: updateTask
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:write
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      requestBody:
        $ref: '#/components/requestBodies/UpdateTaskRequest'
      responses:
        '200':
          $ref: '#/components/responses/LinkToTaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

    delete:
      description: Deletes a task
      operationId: deleteTask
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:admin
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      responses:
        '200':
          $ref: '#/components/responses/SuccessfulOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /tasks/{taskId}/assign:
    put:
      description: Assigns a task to a clerk
      operationId: assignTask
      tags:
        - Tasks
        - Assignments
      security:
        - openIdConnect:
            - task:write
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      requestBody:
        $ref: '#/components/requestBodies/AssignTaskRequest'
      responses:
        '200':
          $ref: '#/components/responses/LinkToTaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /tasks/{taskId}/status:
    put:
      description: Updates the status of a task
      operationId: updateTaskStatus
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:write
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      requestBody:
        $ref: '#/components/requestBodies/UpdateTaskStatusRequest'
      responses:
        '200':
          $ref: '#/components/responses/LinkToTaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /tasks/{taskId}/reject:
    put:
      description: Rejects a task and moves it back to inbox
      operationId: rejectTask
      tags:
        - Tasks
      security:
        - openIdConnect:
            - task:write
      parameters:
        - $ref: '#/components/parameters/TaskIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
      requestBody:
        $ref: '#/components/requestBodies/RejectTaskRequest'
      responses:
        '200':
          $ref: '#/components/responses/LinkToTaskResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /inbox:
    get:
      description: Retrieves tasks from the inbox (unassigned tasks)
      operationId: getInboxTasks
      tags:
        - Inbox
      security:
        - openIdConnect:
            - task:read
      parameters:
        - $ref: '#/components/parameters/VersionParameter'
        - name: limit
          in: query
          description: Maximum number of tasks to return
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: offset
          in: query
          description: Number of tasks to skip for pagination
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        '200':
          $ref: '#/components/responses/TaskListResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

  /clerks/{clerkId}/tasks:
    get:
      description: Retrieves tasks assigned to a specific clerk
      operationId: getClerkTasks
      tags:
        - Tasks
        - Assignments
      security:
        - openIdConnect:
            - task:read
      parameters:
        - $ref: '#/components/parameters/ClerkIdParameter'
        - $ref: '#/components/parameters/VersionParameter'
        - name: status
          in: query
          description: Filter tasks by status
          schema:
            $ref: '#/components/schemas/TaskStatus'
      responses:
        '200':
          $ref: '#/components/responses/TaskListResponse'
        '400':
          $ref: '#/components/responses/BadRequestResponse'
        '403':
          $ref: '#/components/responses/ForbiddenResponse'
        '404':
          $ref: '#/components/responses/NotFoundResponse'
        '500':
          $ref: '#/components/responses/ServiceNotAvailableResponse'
        default:
          $ref: '#/components/responses/DefaultResponse'

components:
  parameters:
    TaskIdParameter:
      name: taskId
      description: Task identifier
      required: true
      in: path
      schema:
        type: string
        format: uuid
        examples:
          - 5dda405a-d28e-490a-8508-1ea3453e91ae

    ClerkIdParameter:
      name: clerkId
      description: Clerk identifier
      required: true
      in: path
      schema:
        type: string
        format: uuid
        examples:
          - 08a13654-05f3-4664-8c8d-fdd9114ec3be

    VersionParameter:
      name: x-version
      description: Version of the API specification used delivered in header
      in: header
      required: true
      schema:
        type: string
        x-extensible-enum:
          - 1.0.0
        default: 1.0.0
        examples:
          - 1.0.0

  responses:
    BadRequestResponse:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    ForbiddenResponse:
      description: Forbidden

    LinkToTaskResponse:
      description: Successful operation - Link to task
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Link"

    NotFoundResponse:
      description: Not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    TaskResponse:
      description: Delivers back the task resource
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TaskFull'

    TaskListResponse:
      description: List of tasks
      content:
        application/json:
          schema:
            type: object
            required:
              - tasks
              - totalCount
            properties:
              tasks:
                type: array
                items:
                  $ref: '#/components/schemas/TaskShort'
              totalCount:
                type: integer
                description: Total number of tasks matching the criteria
                examples:
                  - 150

    ServiceNotAvailableResponse:
      description: Service not available
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    DefaultResponse:
      description: Unexpected error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    SuccessfulOperationResponse:
      description: Successful operation

  requestBodies:
    CreateTaskRequest:
      description: Creates a new task
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TaskCreate'

    UpdateTaskRequest:
      description: Updates a task
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TaskUpdate'

    AssignTaskRequest:
      description: Assigns a task to a clerk
      content:
        application/json:
          schema:
            type: object
            required:
              - assignedTo
            properties:
              assignedTo:
                type: string
                format: uuid
                description: Clerk identifier to assign the task to
                examples:
                  - 08a13654-05f3-4664-8c8d-fdd9114ec3be

    UpdateTaskStatusRequest:
      description: Updates task status
      content:
        application/json:
          schema:
            type: object
            required:
              - status
            properties:
              status:
                $ref: '#/components/schemas/TaskStatus'

    RejectTaskRequest:
      description: Rejects a task with reason
      content:
        application/json:
          schema:
            type: object
            properties:
              reason:
                type: string
                description: Reason for rejecting the task
                minLength: 5
                maxLength: 500
                examples:
                  - Task requirements are unclear

  schemas:
    Error:
      description: An error object used for error responses
      type: object
      required:
        - title
        - status
        - timestamp
      properties:
        title:
          description: A short description of the problem using kebab-cases
          type: string
          minLength: 2
          maxLength: 255
          examples:
            - task-not-found
        detail:
          description: |
            A human-readable description of the problem which can be used by technicians to solve the problem.
          type: string
          examples:
            - The requested task could not be found.
        timestamp:
          description: Point in time when the error occurred
          type: string
          format: date-time
          examples:
            - 2024-07-01T23:32:54T+01:00
        traceparent:
          description: Tracking ID of the API journey
          type: string
          pattern: ^[0-9]{2}-[0-9a-z]{16}-[0-9a-z]{8}-[0-9a-z]{1}[0-9a-z]{1}$
          examples:
            - 00-0af7651916cd43dd8448eb211c80319c-b7ad6b7169203331-01
        severity:
          description: Severity of the according error
          type: string
          enum:
            - FATAL
            - ERROR
            - WARNING
            - INFO
          examples:
            - ERROR

    Link:
      description: Link to an entity
      type: object
      required:
        - type
        - link
      properties:
        type:
          description: Not fully qualified type name of the object
          type: string
          minLength: 2
          maxLength: 155
          examples:
            - Task
        link:
          description: URL to the according entity
          type: string
          format: uri
          examples:
            - https://api.task-management.org/v1/tasks/74d870fa-9e93-4ffd-907e-038c85e8bc20

    TaskStatus:
      description: Status of a task
      type: string
      enum:
        - NEW
        - IN_PROGRESS
        - DONE
        - REJECTED
      examples:
        - NEW

    TaskCreate:
      description: A new task to be created
      type: object
      required:
        - title
      properties:
        title:
          description: Title of the task
          type: string
          minLength: 1
          maxLength: 255
          examples:
            - Review quarterly report
        description:
          description: Detailed description of the task
          type: string
          minLength: 0
          maxLength: 2048
          examples:
            - Please review the Q3 financial report and provide feedback on the budget allocations.
        dueDate:
          description: Due date for the task
          type: string
          format: date
          examples:
            - 2024-12-31

    TaskShort:
      description: Short representation of a task
      type: object
      required:
        - taskId
        - title
        - status
        - createdAt
      properties:
        taskId:
          description: Unique identifier for the task
          type: string
          format: uuid
          examples:
            - 5dda405a-d28e-490a-8508-1ea3453e91ae
        title:
          description: Title of the task
          type: string
          minLength: 1
          maxLength: 255
          examples:
            - Review quarterly report
        status:
          $ref: '#/components/schemas/TaskStatus'
        assignedTo:
          description: Clerk assigned to the task
          type: string
          format: uuid
          examples:
            - 08a13654-05f3-4664-8c8d-fdd9114ec3be
        dueDate:
          description: Due date for the task
          type: string
          format: date
          examples:
            - 2024-12-31
        createdAt:
          description: Timestamp when the task was created
          type: string
          format: date-time
          examples:
            - 2024-07-01T10:30:00Z

    TaskFull:
      description: Full representation of a task
      type: object
      allOf:
        - $ref: '#/components/schemas/TaskShort'
      properties:
        description:
          description: Detailed description of the task
          type: string
          minLength: 0
          maxLength: 2048
          examples:
            - Please review the Q3 financial report and provide feedback on the budget allocations.
        createdBy:
          description: Clerk who created the task
          type: string
          format: uuid
          examples:
            - 12a34b56-78c9-0def-1234-56789abcdef0
        updatedAt:
          description: Timestamp when the task was last updated
          type: string
          format: date-time
          examples:
            - 2024-07-02T14:15:30Z
        rejectionReason:
          description: Reason for task rejection (if applicable)
          type: string
          minLength: 0
          maxLength: 500
          examples:
            - Task requirements are unclear

    TaskUpdate:
      description: Task update payload
      type: object
      properties:
        title:
          description: Title of the task
          type: string
          minLength: 1
          maxLength: 255
          examples:
            - Review quarterly report - Updated
        description:
          description: Detailed description of the task
          type: string
          minLength: 0
          maxLength: 2048
          examples:
            - Please review the Q3 financial report and provide feedback on the budget allocations. Focus on marketing expenses.
        dueDate:
          description: Due date for the task
          type: string
          format: date
          examples:
            - 2024-12-31
        status:
          $ref: '#/components/schemas/TaskStatus'

  securitySchemes:
    openIdConnect:
      type: openIdConnect
      description: Security scheme for task management
      openIdConnectUrl: "https://idp.task-management.org/configuration"
